<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Jiahong&#39;s blog</title>
<link>https://sunjh22.github.io/</link>
<atom:link href="https://sunjh22.github.io/index.xml" rel="self" type="application/rss+xml"/>
<description>A daily summary</description>
<generator>quarto-1.8.26</generator>
<lastBuildDate>Mon, 15 Dec 2025 16:00:00 GMT</lastBuildDate>
<item>
  <title>20251216-Efficient-MST</title>
  <dc:creator>Ryan Sun</dc:creator>
  <link>https://sunjh22.github.io/posts/daily/20251216.html</link>
  <description><![CDATA[ 





<section id="highly-efficient-implementation-minimum-spanning-tree-in-python" class="level1">

<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">Constructs a Minimum Spanning Tree (MST) from single-cell copy number profiles</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">based on the Euclidean distance.</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">Optimized version using pandas, scipy.spatial, and scipy.sparse.</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> argparse</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sys</span>
<span id="cb1-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.spatial.distance <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pdist, squareform</span>
<span id="cb1-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.sparse.csgraph <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> minimum_spanning_tree</span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> main():</span>
<span id="cb1-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 四步：构建参数，添加参数，包装参数和调用参数</span></span>
<span id="cb1-17">    parser <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> argparse.ArgumentParser(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Build an MST from scCNV profiles using Euclidean Distance (Optimized)."</span>)</span>
<span id="cb1-18">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"input_file"</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">help</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Path to the input CNV profile TSV file (bins as columns, cells as rows)."</span>)</span>
<span id="cb1-19">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output_file"</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">help</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Path for the output MST file."</span>)</span>
<span id="cb1-20">    args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parser.parse_args()</span>
<span id="cb1-21"></span>
<span id="cb1-22">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Reading copy number profiles from: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>args<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>input_file<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-23">    </span>
<span id="cb1-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OPTIMIZATION 1: Use pandas for fast I/O</span></span>
<span id="cb1-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reads the entire matrix into memory efficiently. 速度更快，内存消耗更大</span></span>
<span id="cb1-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># header=None assumes the file has no header row (based on your demo file).</span></span>
<span id="cb1-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># index_col=0 uses the first column (Cell IDs) as the index.</span></span>
<span id="cb1-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb1-29">        df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(args.input_file, sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, header<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, index_col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> e:</span>
<span id="cb1-31">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Error reading file: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>e<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-32">        sys.exit(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-33">        </span>
<span id="cb1-34">    n_cells, n_bins <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.shape</span>
<span id="cb1-35">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Successfully read </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n_cells<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> cells and </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n_bins<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> bins."</span>)</span>
<span id="cb1-36"></span>
<span id="cb1-37">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> n_cells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:</span>
<span id="cb1-38">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Error: Need at least 2 cells to build a tree."</span>)</span>
<span id="cb1-39">        sys.exit(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-40"></span>
<span id="cb1-41">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OPTIMIZATION 2: Vectorized distance calculation</span></span>
<span id="cb1-42">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Calculating pairwise Euclidean distances..."</span>)</span>
<span id="cb1-43">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pdist computes pairwise distances in C, which is orders of magnitude faster than Python loops.</span></span>
<span id="cb1-44">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># It returns a condensed distance matrix to save memory.</span></span>
<span id="cb1-45">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb1-46">        dist_condensed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pdist(df.values, metric<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'euclidean'</span>)</span>
<span id="cb1-47">        dist_matrix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> squareform(dist_condensed)</span>
<span id="cb1-48">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">MemoryError</span>:</span>
<span id="cb1-49">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Error: Not enough memory to compute the full distance matrix."</span>)</span>
<span id="cb1-50">        sys.exit(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-51">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> e:</span>
<span id="cb1-52">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Error calculating distances: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>e<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-53">        sys.exit(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-54"></span>
<span id="cb1-55">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OPTIMIZATION 3: Efficient MST algorithm</span></span>
<span id="cb1-56">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Constructing Minimum Spanning Tree..."</span>)</span>
<span id="cb1-57">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># uses efficient implementation (Kruskal's/Prim's) from scipy</span></span>
<span id="cb1-58">    mst_csr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> minimum_spanning_tree(dist_matrix)</span>
<span id="cb1-59">    </span>
<span id="cb1-60">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the sparse matrix to Coordinate (COO) format to extract edges easily</span></span>
<span id="cb1-61">    mst_coo <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mst_csr.tocoo()</span>
<span id="cb1-62">    </span>
<span id="cb1-63">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Writing MST to: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>args<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>output_file<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-64">    cell_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.index</span>
<span id="cb1-65">    </span>
<span id="cb1-66">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb1-67">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(args.output_file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb1-68">            f.write(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"from</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">to</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">distance</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-69">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate through the edges found by the MST algorithm</span></span>
<span id="cb1-70">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> u, v, w <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(mst_coo.row, mst_coo.col, mst_coo.data):</span>
<span id="cb1-71">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Map numeric indices back to original Cell IDs</span></span>
<span id="cb1-72">                f.write(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>cell_ids[u]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>cell_ids[v]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>w<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-73">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">IOError</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> e:</span>
<span id="cb1-74">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Error writing output file: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>e<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-75">        sys.exit(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-76"></span>
<span id="cb1-77">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Euclidean Tree inference finished successfully!"</span>)</span>
<span id="cb1-78"></span>
<span id="cb1-79"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__main__"</span>:</span>
<span id="cb1-80">    main()</span></code></pre></div></div>


<!-- -->

</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>daily</category>
  <category>Python</category>
  <category>MST</category>
  <guid>https://sunjh22.github.io/posts/daily/20251216.html</guid>
  <pubDate>Mon, 15 Dec 2025 16:00:00 GMT</pubDate>
</item>
<item>
  <title>20251215-UKBiobank</title>
  <dc:creator>Ryan Sun</dc:creator>
  <link>https://sunjh22.github.io/posts/daily/20251215.html</link>
  <description><![CDATA[ 





<section id="python-skills" class="level1">
<h1>Python skills</h1>
<ol type="1">
<li>定义一个函数： def some_function(variable1: type, variable2: type) -&gt; type of return value。举个栗子：def read_copy_number_profiles(filepath: str) -&gt; Dict[str, np.ndarray]:</li>
<li>定义一个变量：variable1: Dict[str, list[int]] = {}。举个栗子：profiles: Dict[str, list[int]] = {}</li>
<li>Convert lists to Numpy array: np.array(list, dtype=int)</li>
<li>argparse用法 4.1 初始化：parser = argparse.ArgumentParser(description=““) 4.2 添加参数: parser.add_argument(”input_file”, help=““), parser.add_argument(”output_file”, help=““) 4.3 包装参数: args = parser.parse_args() 4.4 调用参数: input_file = args.input_file</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform statistical test in Python</span></span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> stats</span>
<span id="cb1-3">cml_counts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10671</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26081</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26593</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96335</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">110570</span>]</span>
<span id="cb1-4">healthy_counts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101835</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">431203</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">183384</span>]</span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># T-test</span></span>
<span id="cb1-6">t_stat1, p_val1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> stats.ttest_ind(cml_counts, healthy_counts, equal_var<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mann-Whiteney U test</span></span>
<span id="cb1-8">t_stat, p_val <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> stats.mannwhitneyu(cml_counts, healthy_counts, equal_var<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span></code></pre></div></div>
</section>
<section id="linux-skills" class="level1">
<h1>Linux skills</h1>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use AWK to filter rows, usage of &amp;&amp; and ||</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NormB'</span> PC1_clusterA_metadata.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">','</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR == 1 { print; next } {cnv = $4; ploidy = $5} cnv &gt; 0.03693037 &amp;&amp; (ploidy &lt; 1.98583 || ploidy &gt; 2.015871)'</span> </span></code></pre></div></div>
</section>
<section id="apply-for-uk-biobank-data-access" class="level1">
<h1>Apply for UK Biobank data access</h1>
<p>Deciphering the Immunogenetic Landscape: Epistatic Interactions between HLA and KIR Loci and their Impact on Human Health Phenotypes in the UK Biobank</p>
<ol type="1">
<li><p>Scientific Rationale 1.1 Background: Natural Killer (NK) cells are pivotal in the innate immune response against viral infections and tumors. Their function is tightly regulated by the interaction between KIR receptors (encoded on chromosome 19) and their specific HLA class I ligands (encoded on chromosome 6). 1.2 The Gap: Both gene families are highly polymorphic. While HLA associations with disease are well-documented, the epistatic (combinatorial) effect of HLA-KIR pairs is less understood, primarily because most studies lack the sample size to detect these complex interactions. 1.3 UK Biobank Advantage: The UKB offers a unique opportunity to study these interactions at scale. The availability of Whole Exome Sequencing (WES) and Whole Genome Sequencing (WGS) allows for the direct calling of complex KIR copy numbers and alleles, which can then be correlated with the rich phenotypic data available.</p></li>
<li><p>Research Questions 2.1 What is the landscape of KIR allelic diversity and copy number variation (CNV) across the UK Biobank population, and how does it stratify by ancestry? 2.2 How do specific epistatic combinations of KIR receptors and their cognate HLA ligands (e.g., KIR2DL1 with HLA-C2) influence susceptibility to immune-mediated diseases, infections, and cancer? 2.3 Can we identify novel pleiotropic effects of HLA-KIR interactions across a broad spectrum of phenotypes (PheWAS)?</p></li>
<li><p>Specific Objectives Objective 1: Immunogenetic Profiling. To determine high-resolution HLA alleles and KIR genotypes (including copy number and allelic variants) for UK Biobank participants. Note: HLA is already imputed in UKB, but KIR often requires running specific calling tools (like T1K or KIRCLE) on the WES/WGS data. Objective 2: Epistatic Interaction Mapping. To classify individuals based on functional NK cell “education” status (e.g., Receptor-Ligand match vs.&nbsp;mismatch) and define interaction terms (e.g., KIR3DL1+HLA-Bw4). Objective 3: Phenome-Wide Association Study (PheWAS). To perform a PheWAS to systematically screen for associations between HLA-KIR combinations and diverse phenotypes, with a focus on: Autoimmunity: Rheumatoid arthritis, Psoriasis, IBD. Infection: Viral susceptibility (e.g., severe influenza, COVID-19 severity). Malignancy: Hematological cancers and solid tumors.</p></li>
</ol>
<p>This research will clarify the “missing heritability” in immune-mediated diseases by looking beyond single-gene effects to gene-gene interactions. Understanding these mechanisms could lead to better risk stratification for patients and potential therapeutic targets involving NK cell modulation (e.g., checkpoint inhibitors).</p>
<p>This research is in the public interest because it aims to improve the understanding of the genetic mechanisms underlying human immune response, specifically the interactions between HLA and KIR gene families. While these genes are known to be critical for fighting infections and cancer, their combined diversity is complex and poorly understood at the population level. By characterizing these variations in the UK Biobank, this project seeks to: 1. Identify genetic markers that predict susceptibility to immune-mediated diseases and cancer. 2. Clarify the ‘missing heritability’ in complex disease traits that single-gene studies have failed to capture. Ultimately, this work aims to provide fundamental knowledge that could lead to improved risk stratification and the development of targeted immunotherapies. We are committed to publishing our findings in peer-reviewed scientific journals and sharing any developed bioinformatics tools with the research community to maximize the utility of this resource.</p>
</section>
<section id="hla-kir" class="level1">
<h1>HLA &amp; KIR</h1>
<p>4-field allele calls 1: represent broad antigen group 2: indicate a unique protein variant, may affect T-cell binding 3: denote a sepcific silent variant, do not affect protein 4: non-coding region variations, including introns, 5’/3’ UTRs, promoter and enhancer</p>
<p>over 30,000 HLA alleles in IMGT/HLA database</p>
<p>HLA locus (chromosome 6p21.3), ~5Mb, ~140 genes, Class I and II are core loci, most genes have copy number of 2, DRB3/4/5 generally have CNVs</p>
<p>KIR locus (chromosome 19q13.42), ~150kb, 15 functional genes + 2 pseudogenes</p>


<!-- -->

</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>daily</category>
  <guid>https://sunjh22.github.io/posts/daily/20251215.html</guid>
  <pubDate>Sun, 14 Dec 2025 16:00:00 GMT</pubDate>
</item>
<item>
  <title>20251213-Weekly summary</title>
  <dc:creator>Ryan Sun</dc:creator>
  <link>https://sunjh22.github.io/posts/weekly/20251213.html</link>
  <description><![CDATA[ 





<p>This is a test weekly summary page.</p>


<!-- -->


<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>weekly</category>
  <guid>https://sunjh22.github.io/posts/weekly/20251213.html</guid>
  <pubDate>Fri, 12 Dec 2025 16:00:00 GMT</pubDate>
</item>
<item>
  <title>20251209-ATAC-seq v.s ChIP-seq</title>
  <dc:creator>Ryan Sun</dc:creator>
  <link>https://sunjh22.github.io/posts/daily/20251209.html</link>
  <description><![CDATA[ 





<p>ATAC-seq is used to find genomewide open regions that any protein could bind, including transcription binding site, promoters and enhancers (non-specific). Use hyperactive Tn5 transposase on unfixed nuclei, typically requires 500-50,000 cells as input, it is simple and fast.</p>
<p>ChIP-seq is used to find the binding site of specific proteins (e.g transcription factors) or screen the specific histone modifications by specific antibodies (specific). Use specific antibody against the protein/modification of interest on crosslinked (fixed) chromatin, typically requires 1-10 million cells, it is more labor-intensive.</p>
<p>As seen in <strong>?@fig-histone</strong>, there are six common histone modifications. <img src="https://sunjh22.github.io/images/common-histone-modifications.png" id="fig-histone" class="img-fluid" alt="Common histone modifications"></p>
<p><strong>?@fig-antibody</strong> shows the current best-practice panel (what most big consortia and top labs use in 2024–2025) for mapping histone modifications. <img src="https://sunjh22.github.io/images/antibodies-for-histone-modifications.png" id="fig-antibody" class="img-fluid" alt="Best-practice antibody panel"></p>


<!-- -->


<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>daily</category>
  <category>ATAC-seq</category>
  <guid>https://sunjh22.github.io/posts/daily/20251209.html</guid>
  <pubDate>Mon, 08 Dec 2025 16:00:00 GMT</pubDate>
</item>
<item>
  <title>20251208-How to build a website on Github</title>
  <dc:creator>Ryan Sun</dc:creator>
  <link>https://sunjh22.github.io/posts/daily/20251208.html</link>
  <description><![CDATA[ 





<p>About three years ago, I built a blog website on Github using jekyll, now I want to re-start, so I asked Gemini 3 to help me. I followed its instructions and successfully built it.</p>
<section id="archive-previous-site" class="level1">
<h1>1. Archive previous site</h1>
<ol type="1">
<li>Go to your existing repository on GitHub.</li>
<li>Click Settings -&gt; General.</li>
<li>Rename the repository to something like blog-archive-jekyll.</li>
<li>Create a new repository named sunjh22.github.io.</li>
</ol>
</section>
<section id="create-new-repository" class="level1">
<h1>2. Create new repository</h1>
<ol type="1">
<li>Create a new repository named sunjh22.github.io.</li>
<li>Initialize it with a README.md.</li>
<li>Go to Settings &gt; Pages and set the “Source” to Deploy from a branch -&gt; main -&gt; /docs. (We will configure Quarto to render to a /docs folder).</li>
</ol>
</section>
<section id="download-and-install-quarto" class="level1">
<h1>3. Download and install Quarto</h1>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/quarto-dev/quarto-cli/releases/download/v1.8.26/quarto-1.8.26-linux-amd64.tar.gz</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzf</span> quarto-1.8.26-linux-amd64.tar.gz</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ln</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> /home/sunjh/data/biosoft/quarto-1.8.26/bin/quarto ~/data/bin/</span></code></pre></div></div>
</section>
<section id="initialize-the-project" class="level1">
<h1>4. Initialize the Project</h1>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/sunjh22/sunjh22.github.io.git</span>
<span id="cb2-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> sunjh22.github.io</span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quarto</span> create-project myblog <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--type</span> website:blog</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> myblog/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> .</span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> myblog/.gitignore .</span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rmdir</span> myblog</span></code></pre></div></div>
</section>
<section id="configure-for-github-pages" class="level1">
<h1>5. Configure for GitHub Pages</h1>
<p>Edit <code>_quarto.yml</code>, <code>index.qmd</code> and <code>about.qmd</code>. All the new posts should be under ‘posts/’ directory, make three sub-directories ‘posts/bioinfo’, ‘posts/life’ and ‘posts/daily’.</p>
</section>
<section id="preview-and-publish" class="level1">
<h1>6. Preview and Publish</h1>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Because the port restriction, preview function is not available now.</span></span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quarto</span> preview</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Render the full site</span></span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quarto</span> render</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Push to Github</span></span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> add .</span>
<span id="cb3-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> commit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Initial commit"</span></span>
<span id="cb3-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> push origin main</span></code></pre></div></div>
</section>
<section id="bonus-for-git-push" class="level1">
<h1>Bonus for git push</h1>
<ol type="1">
<li>Check for existing SSH keys:</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-al</span> ~/.ssh</span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">If</span> you see id_ed25519.pub or id_rsa.pub, skip to step 3.</span></code></pre></div></div>
<ol start="2" type="1">
<li>Generate a new SSH key:</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh-keygen</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> ed25519 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-C</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your_email@example.com"</span></span></code></pre></div></div>
<p>(Press Enter through all prompts to accept defaults).</p>
<ol start="3" type="1">
<li>Add the key to GitHub: Display your public key:</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> ~/.ssh/id_ed25519.pub</span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Or cat ~/.ssh/id_rsa.pub</span></span></code></pre></div></div>
<p>Copy the output (starts with ssh-ed25519…). Go to GitHub Settings → SSH and GPG keys → New SSH key. Paste the key and save.</p>
<ol start="4" type="1">
<li>Switch your repository to use SSH: Currently, your repo is looking for the HTTPS link. You need to point it to the SSH link.</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change remote URL from HTTPS to SSH</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> remote set-url origin git@github.com:sunjh22/sunjh22.github.io.git</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Verify it changed</span></span>
<span id="cb7-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> remote <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Should show: origin  git@github.com:sunjh22/sunjh22.github.io.git (fetch)</span></span></code></pre></div></div>
<ol start="5" type="1">
<li>Push:</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> push origin main</span></code></pre></div></div>


<!-- -->

</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>daily</category>
  <category>tutorial</category>
  <guid>https://sunjh22.github.io/posts/daily/20251208.html</guid>
  <pubDate>Sun, 07 Dec 2025 16:00:00 GMT</pubDate>
</item>
<item>
  <title>My Weekend Spicy Tofu Recipe</title>
  <link>https://sunjh22.github.io/posts/life/spicy-tofy.html</link>
  <description><![CDATA[ 





<section id="ingredients" class="level2">

<ul>
<li>Tofu</li>
<li>Chili Oil</li>
</ul>


<!-- -->

</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>Food</category>
  <category>Recipes</category>
  <category>Spicy</category>
  <guid>https://sunjh22.github.io/posts/life/spicy-tofy.html</guid>
  <pubDate>Mon, 20 May 2024 16:00:00 GMT</pubDate>
</item>
<item>
  <title>Single Cell Analysis with Seurat</title>
  <link>https://sunjh22.github.io/posts/bioinfo/single-cell-analysis.html</link>
  <description><![CDATA[ 





<p>Here is how I normalize data:</p>
<p>library(Seurat) # Code actually runs and displays output! pbmc &lt;- NormalizeData(pbmc)</p>


<!-- -->


<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>Bioinformatics</category>
  <category>R</category>
  <category>scRNA-seq</category>
  <guid>https://sunjh22.github.io/posts/bioinfo/single-cell-analysis.html</guid>
  <pubDate>Sun, 19 May 2024 16:00:00 GMT</pubDate>
</item>
</channel>
</rss>
